\documentclass{article}
\newcommand{\R}[1]{\mathtt{#1}}
\newcommand{\K}[1]{\mathrm{#1}}
\newcommand{\both}{\leftrightarrow}
\usepackage[pdfborder={0 0 0}]{hyperref}
\usepackage{fancyhdr}
\usepackage{threeparttable}
\usepackage[nodayofweek]{datetime}
\usepackage[letterpaper,margin=1in]{geometry}

\newdateformat{isodate}{\THEYEAR-\twodigit{\THEMONTH}-\twodigit{\THEDAY}}

\title{Alpha Language Standard}
\author{Christopher Pavlina}
\date{\isodate\today: Ed. 1} %FIXME

\pagestyle{fancy}
\makeatletter
\lhead{\@title}
\rhead{\thesubsection}
\lfoot{\@date}
\cfoot{}
\rfoot{\thepage}
\makeatother
\begin{document}

\makeatletter
\thispagestyle{empty}
\begin{center}
\huge{\@title} \\
\Large{\@author} \\
\large{First Edition: \today}
\end{center}
\hrule
\tableofcontents
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PREFACE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\phantomsection
\addcontentsline{toc}{section}{Preface}
\section*{Preface}
\label{sec:preface}
Blah.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INTRODUCTION
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{sec:intro}
Blah.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% GRAMMAR SPECIFICATION
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Grammar specification}
\label{sec:grammar}
The grammar for Alpha is specified in a rough Extended Backus-Naur Form. I'll
spare you an introduction to it, but here is a rough table of the allowed
symbols.

\begin{tabular}{|l|c|}
\hline
Definition & \texttt{=} \\
Concatenation & \texttt{,} \\
End of definition & \texttt{;} \\
Choice of & \texttt{|} \\
Optional & \texttt{[} ... \texttt{]} \\
Repeating (one or more) & \texttt{\{} ... \texttt{\}} \\
Grouped & \texttt{(} ... \texttt{)} \\
String & \texttt{"} ... \texttt{"} \\
ASCII char $xx$ & \texttt{\textbackslash xx} \\
Comment & \texttt{(*} ... \texttt{*)} \\
Exclude & \texttt{-} ... \\
Through & ... \texttt{>} ... \\
\hline
\end{tabular}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% LEXICALS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Lexicals}
\label{sec:lexicals}

\subsection{Encoding}
\label{sec:encoding}
While Alpha has Unicode support in compiled programs, the source code itself
must be ASCII.
\begin{verbatim}
Newline = [\0D], \0A ;
\end{verbatim}

\subsection{Tokens}
\label{sub:lexicals:tokens}
\begin{verbatim}
digit       = "0" | "1" > "9" ;
alpha       = "A" > "Z" | "a" > "z" ;
printable   = \20 > \7E ;
exponent    = ("e" | "E"), [("+" | "-")], {digit} ;
Real        = [{digit}], ".", {digit}, [exponent] ;
hex         = digit | "A" > "F" | "a" > "f" ;
dec         = digit ;
oct         = digit -("8" | "9") ;
bin         = "0" | "1" ;
Integer     = (  (( "0X" | "0x" ), { hex })
               | ([ "0D" | "0d" ], { dec })
               | (( "0O" | "0o" ), { oct })
               | (( "0B" | "0b" ), { bin }) ) ;
WordExclAt  = (alpha | "_"), [{digit | alpha | "_"}] ;
Word        = ["@"], WordExclAt ;
uarithop    = "++" | "--" | "~" | "-" ;
barithop    = "*" | "/" | "%" | "%%" | "+" | "-" | "<<" | ">>" | "&" |
              "^" | "|" ;
logop       = "!" | "&&" | "||" ;
eqop        = "<" | "<=" | ">" | ">=" | "==" | "!=" | "is" | "isnot" ;
assignop    = [barithop], "=" ;
typeop      = "sizeof" | "new" | "delete" | "hastype" | "typename" |
              "as" ;
umemop      = "*" | "&" ;
sepop       = "(" | ")" | "[" | "]" | "{" | "}" | "," | "." ;
Operator    = uarithop | barithop | logop | eqop | assignop | typeop |
              umemop | sepop ;
escape      = "\", ("a" | "b" | "f" | "n" | "r" | "t" | "v" | "'" |
                    \22 | "\" | ("x", hex, hex)) ;
(* \22 is " *)
String      = \22, [{(printable -("\" | \22)) | escape}], \22 ;
Character   = "'", ((printable -("\" | "'")) | escape), "'" ;
Token       = Real | Integer | Word | Operator | String | Character ;
\end{verbatim}

\subsection{Whitespace}
\label{sub:lexicals:whitespace}
\begin{verbatim}
(* space, hor. tab, newline, vert. tab, formfeed, carraige return *)
Whitespace = " " | \09 | \0A | \0B | \0C | \0D ;
\end{verbatim}
All whitespace is ignored; it has no effect on lexical analysis.

\subsection{Comments}
\label{sub:lexicals:comments}
\begin{verbatim}
linecomment  = "//", rest_of_line ;
blockcomment = "/*", anything, "*/" ;
Comment      = linecomment | blockcomment ;
\end{verbatim}
Note that \texttt{anything} above implies that block comments may be nested.
Comments are to be treated as whitespace.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% KEYWORDS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Keywords}
\label{sec:keywords}
The following words are keywords. They are invalid for use as type or variable
names.

\texttt{class} (\ref{sub:classes:definition}),
\texttt{method} (\ref{sub:methods:definition}),
\texttt{extern} (\ref{sub:methods:extern}),
\texttt{return} (\ref{sub:statements:return}),
\texttt{let} (\ref{sub:statements:vardecl}),
\texttt{const} (\ref{sub:statements:vardecl}, \ref{sub:types:const}),
\texttt{static} (\ref{sub:methods:static}, \ref{sub:classes:static}),
\texttt{nomangle} (\ref{sub:methods:mangle}),
\texttt{threadlocal} (\ref{sub:globals:threadlocal},
                      \ref{sub:classes:threadlocal}),
\texttt{null} (\ref{sub:types:null}),
\texttt{record} (\ref{sub:types:record}),
\texttt{switch} (\ref{sub:statements:switch}),
\texttt{case} (\ref{sub:statements:switch}),
\texttt{default} (\ref{sub:statements:switch}),
\texttt{if} (\ref{sub:statements:if}),
\texttt{else} (\ref{sub:statements:if}),
\texttt{for} (\ref{sub:statements:for}),
\texttt{foreach} (\ref{sub:statements:foreach}),
\texttt{do} (\ref{sub:statements:do}),
\texttt{while} (\ref{sub:statements:while}, \ref{sub:statements:do}),
\texttt{as} (\ref{sub:operators:cast})

\ \\

The following words are primitive type names. They are invalid for use as
variable names. Note that user-defined types may also be used as variable names;
the language design does not allow ambiguities.

\texttt{i8},
\texttt{i16},
\texttt{i32},
\texttt{i64},
\texttt{u8},
\texttt{u16},
\texttt{u32},
\texttt{u64},
\texttt{ssize},
\texttt{int},
\texttt{size},
\texttt{unsigned},
\texttt{float},
\texttt{double},
\texttt{var},
\texttt{void}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TYPES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Types}
\label{sec:types}

%%%%%%%%%%%%%%%%%%%%%%
% IN-DOCUMENT NOTATION
\subsection{In-document notation}
\label{sub:types:indoc}
The following notation will be used in this document for types:

\begin{tabular}{|l|l|}
\hline
Signed int, $n$ bits & $\R{SI}_n$ \\
Unsigned int, $n$ bits & $\R{UI}_n$ \\
Floating point, $n$ bits & $\R{FP}_n$ \\
Pointer to $T$ & $T^*$ \\
Array of $T$ & $T^{[]}$ \\
Constant $T$ & $\overline{T}$ \\
Class $\R{c}$ & $\K{c}$ \\
Class $\R{c} \textrm{ with arguments } k, \ldots, k$ & $\K{c}(k, \ldots, k)$ \\
Null type & $\emptyset$ \\
\hline
\end{tabular}

For example, \texttt{map$<$string, int$>$} is
$\K{map}(\K{string}, \R{SI}_{32})$.

%%%%%%%
% NAMES
\subsection{Names}
\label{sub:types:names}
Following is a correlation of types to their Alpha names:

\begin{tabular}{|l|l|}
\hline
$\R{SI}_8$ & \texttt{i8} \\
$\R{SI}_{16}$ & \texttt{i16} \\
$\R{SI}_{32}$ & \texttt{i32} or \texttt{int} \\
$\R{SI}_{64}$ & \texttt{i64} \\
$\R{UI}_8$ & \texttt{u8} \\
$\R{UI}_{16}$ & \texttt{u16} \\
$\R{UI}_{32}$ & \texttt{u32} or \texttt{unsigned} \\
$\R{UI}_{64}$ & \texttt{u64} \\
$\R{FP}_{32}$ & \texttt{float} \\
$\R{FP}_{64}$ & \texttt{double} \\
$T^{[]}$ & $T$\texttt{[]} \\
$T^*$ & $T$\texttt{*} \\
$\overline{T}$ & $T$ \texttt{const} \\
$\mathrm{c}$ & \texttt{c} \\
$\mathrm{c}(k,\ldots,k)$ & \texttt{c$<$k,~...,~k$>$} \\
\hline
\end{tabular}

%%%%%%%%%%
% LITERALS
\subsection{Literals}
\label{sub:types:literals}
\begin{verbatim}
nullLit   = "null" ;
charLit   = Character ;
intLit    = Integer ;
floatLit  = Real ;
arrayLit  = "c{", [Literal, [{",", Literal}]], "}" ;
stringLit = String ;
Literal   = nullLit | intLit | floatLit | arrayLit | stringLit ;
\end{verbatim}

\begin{itemize}
  \item{The null literal \texttt{nullLit} is the only value of type $\emptyset$.}
  \item{Character literals are of type $\R{UI}_{8}$ and contain the ASCII value
    of the character.}
  \item{String literals are of type $\overline{\R{UI}_{8}\,\!^{[]}}$, and contain
    the given sequence of character codes, followed by 0.}
  \item{Array literals are of type $\overline{T}$, where $T$ is the type of the
    contained elements. It is a compile-time error for the elements not to all
    share a type.}
  \item{Integer literals are, of course, integers. They are resolved to a type
    after the arithmetic folding (\ref{sub:passes:arithfold}). The type of an
    integer literal is the first of $\R{SI}_{32}$, $\R{SI}_{64}$, $\R{UI}_{64}$
    which can contain the value.}
  \item{Float literals are always of type $\R{FP}_{64}$, never $\R{FP}_{32}$.}
\end{itemize}

%%%%%%%%%
% CASTING
\subsection{Casting}
\label{sub:types:casting}
\subsubsection{Allowed casts}
See \ref{sub:operators:cast}.
All casts not explicitly permitted are forbidden. The following casts are
permitted:
\begin{itemize}
  \item{$T \both T$ \\
    This cast must do nothing.}
  \item{$\R{SI}_a \both \R{UI}_a$ \\
    Re-interpret the binary encoding of one as the other. For example,
    the $\R{SI}_8$ $-128$ casts to the $\R{UI}_8$ $255$ because both are
    encoded as $\mathrm{FF}_{16}$.}
  \item{$\R{SI}_a \both \R{SI}_b$ \\
    If casting from narrow to wide, return the wider $\R{SI}$ which represents
    the same number. In other words, if $b > a$, $\R{SI}_a\,N$ must always cast
    to $\R{SI}_b\,N$. \\
    If casting from wide to narrow, truncate the integer from the most
    significant end to fit.}
  \item{$\R{UI}_a \both \R{UI}_b$ \\
    If casting from narrow to wide, return the wider $\R{UI}$ which represents
    the same number. In other words, if $b > a$, $\R{UI}_a\,N$ must always cast
    to $\R{UI}_b\,N$. \\
    If casting from wide to narrow, truncate the integer from the most
    significant end to fit.}
  \item{$\R{SI}_\mathrm{any} \both \R{FP}_\mathrm{any}$ \\
    Perform the architecture's usual conversion between signed integer and
    floating point. For example, the compiler as of this writing uses the
    LLVM instructions \texttt{sitofp} and \texttt{fptosi}.}
  \item{$\R{UI}_\mathrm{any} \both \R{FP}_\mathrm{any}$ \\
    Perform the architecture's usual conversion between unsigned integer and
    floating point. For example, the compiler as of this writing uses the
    LLVM instructions \texttt{uitofp} and \texttt{fptoui}.}
  \item{$\R{FP}_a \both \R{FP}_b$ \\
    Extend or truncate the floating-point value to the desired size. This
    operation should only change the precision of the float (with the exception
    of values outside the range of the wider number).}
  \item{$T^* \both U^*$ \\
    Return a pointer to the same memory address, of the new type.}
  \item{$T^* \both \R{UI}_a$, where $a > \textrm{width of pointer}$ \\
    Ensure: $[T^*\;x \to \R{UI}_a\;y \to T^*\;z] \Rightarrow [x = z]$}
  \item{$T^{[]} \to T^*$ \\
    If the $T^{[]}$ is null, the $T^*$ should be the null pointer, otherwise,
    the $T^*$ should point to the first element of the $T^{[]}$.}
  \item{$\overline{T} \both T$ \\
    Add or remove the \texttt{const} specifier.}
  \item{$\emptyset \to \R{SI}_a$ \\
    Return $0$.}
  \item{$\emptyset \to \R{UI}_a$ \\
    Return $0$.}
  \item{$\emptyset \to T$ where $T$ is a class \\
    Return the null reference of type $T$.}
  \item{$\emptyset \to T^{[]}$ \\
    Return the null reference of type $T^{[]}$.}
  \item{$\emptyset \to T^*$ \\
    Return the null pointer. This should be the pointer $T^*\;x$ such that
    $x \to \R{UI}_n = 0$.}
\end{itemize}
Note that $\R{SI}_a \both \R{UI}_b$ is disallowed because sign casts and width
casts are not commutative. You must perform one of
$\R{SI}_a \to \R{UI}_a \to \R{UI}_b$ or $\R{SI}_a \to \R{SI}_b \to \R{UI}_b$.
\subsubsection{Implicit casts}
The following casts may be performed implicitly. That is, if the cast
$A \to B$ appears below, it is possible to assign a value of type $A$ directly
to a variable of type $B$, or use it as an argument to a parameter of type
$B$. The compiler should insert the cast implicitly.

\begin{itemize}
\item{$\R{SI}_a \to \R{SI}_b$, where $b \geq a$}
\item{$\R{UI}_a \to \R{UI}_b$, where $b \geq a$}
\item{Integer literal $\in \R{SI}_a \to \R{SI}_a$}
\item{Integer literal $\in \R{UI}_a \to \R{UI}_a$}
\item{$T^{[]} \to T^*$}
\item{$\emptyset \to \R{SI}_a$}
\item{$\emptyset \to \R{UI}_a$}
\item{$\emptyset \to T$ where $T$ is a class}
\item{$\emptyset \to T^{[]}$}
\item{$\emptyset \to T^*$}
\end{itemize}

%%%%%%%%%%%%%%%%
% CONSTANT TYPES
\subsection{Constant types}
\label{sub:types:const}
See \ref{sub:statements:vardecl}.
A constant type $\overline{T}$ may be specified as $T$~\texttt{const}. A
``variable'' declared constant may be stored in a read-only area in the
program's memory, and it is a compile-time error to assign to it.
This constant specifier may be casted off. Compilers are forbidden from
emitting warnings or errors if this is done. The result of the following
is undefined:
\begin{verbatim}
const x: 2;
let xp: &x as int*;
*xp = 3;
\end{verbatim}

%%%%%%
% NULL
\subsection{The null type}
\label{sub:types:null}

%%%%%%%%%
% RECORDS
\subsection{Records}
\label{sub:types:record}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% OPERATORS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Operators}
\label{sec:operators}

\subsection{Precedence}
\label{sub:operators:precedence}
\begin{center}
  \begin{threeparttable}
    \caption{Operator precedence, high to low}
    \begin{tabular}{|c|c|c|l|}
      \hline
      \texttt{*} & Unary & R$\to$L & Dereference \\ \hline
      \texttt{\&} & Unary & R$\to$L & Address of \\ \hline
      \texttt{as} $type$ & Unary$^\dagger$ & L$\to$R & Cast to $type$ \\ \hline
      \texttt{=} & Binary & R$\to$L & Assignment \\ \hline
      \texttt{,} & Binary & L$\to$R & Comma (function arguments, assignment tuples) \\ \hline
    \end{tabular}
    \begin{tablenotes}
      \item{$\dagger$ \small{The cast operator is technically unary, but comes
          \emph{after}
          the value in question, and functions as a binary operator. Because the current
          compiler code treats arity and number of operands separately, it is implemented
          as a binary operator which accepts one operand.}}
    \end{tablenotes}
  \end{threeparttable}
\end{center}

\subsection{Cast (\texttt{as})}
\label{sub:operators:cast}

\subsection{Assign (\texttt{=})}
\label{sub:operators:assign}
The assignment operator (\texttt{=}) is used to assign a value to any item with
a writable pointer (usually variables). Additionally, it can be used to assign
a tuple of values, or a function returning multiple values.
Examples:
\begin{verbatim}
(int, int) returnsTwo () {
    return 2, 3;
}

int main (u8[][] argv) {
    let x: 5, y: 6, z: 7;

    z = 8;
    // z now contains 8

    (x, y) = (y, x);
    // x now contains 6, and y contains 5

    (x, y) = returnsTwo ();
    // x now contains 2, and y contains 3
}
\end{verbatim}

Note that because the comma has a lower precedence than the equals sign,
parentheses must be used to group the tuples. If a multiple assignment is
asymmetric (the number of values does not equal the number of destinations),
the minimum of the two shall be assigned, and any unused values shall not be
evaluated:
\begin{verbatim}
(x, y, z) = (1, 2);
// z is untouched

(x, y) = (1, 2, withSideEffects ());
// The side effects never happen because withSideEffects () is never
// evaluated.
\end{verbatim}

The assignment operator is just that --- an operator --- and any use of it has
a value. For a single assignment, the value of the assignment is the value
assigned. For a multiple assignment, the value of the assignment is the first
of the values assigned. Examples:
\begin{verbatim}
let x: 0, y: 0;

x = y = 3;  // Equivalent to x = (y = 3)
// x and y now both contain 3

let z: (x, y) = (5, 6);
// z now contains 5

// WARNING: The following does not do what it looks like (see above:
// the value of a multiple assignment is the first assigned value,
// and extraneous items on either side are ignored):
(x, y) = (y, x) = (z, y);
// Result:
//   Assign x := y, y := z
//   Assign x := y
// In the end, x, y, and z all have the same value.
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% EXPRESSIONS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Expressions}
\label{sec:expressions}

\subsection{Names}
\label{sub:expressions:names}
\begin{verbatim}
localName   = WordExclAt ;
classVar    = "@", WordExclAt ;
className   = WordExclAt ;
packageName = WordExclAt ;
classDbl    = className, ".", packageName ;
packageTpl  = packageName, ".", classDbl ;
\end{verbatim}

Note that \texttt{localName}, \texttt{className}, and \texttt{packageName} are
defined the same. A package triple (\texttt{packageTpl}) is a fully qualified
name. Packages may not be nested; if you desire nested packages to clarify your
code, consider using an underscore to separate name parts.

Alpha is designed to always have clarity between names and types; there should
never be a question as to whether something is a name or a type. When resolving
names and types, more local should be considered before more distant.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% STATEMENTS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Statements}
\label{sec:statements}

\subsection{Variable and constant declaration (\texttt{let} and \texttt{const})}
\label{sub:statements:vardecl}
\begin{verbatim}
localname =;
VarDecl   = "let", ["volatile"], WordExclAt, [typename], ":", Expression,
            [{",", ["volatile"], WordExclAt, [typename], ":", Expression}]
ConstDecl = "const", ["volatile"], WordExclAt, [typename], ":", Expression,
            [{",", ["volatile"], WordExclAt, [typename], ":", Expression}]
\end{verbatim}
Note the general format:
\begin{verbatim}
let varA: 2, varB i8: 3 + someOtherVar;
const cstA: 3, cstB: 5 + varB;
\end{verbatim}
A VarDecl declares all of its variables for use in the current scope. The
expression, which is required, is evaluated at runtime and assigned to the
variable.

A ConstDecl declares all of its constants for use in the current scope, with the
additional requirement that they be globally usable (but not by name). That is,
if you declare \texttt{const~x:~3;}, you can only access the constant by name in
the scope in which it was declared, but the value of \texttt{\&x} will be valid
globally.

The expression for a constant need not be constant itself; it will be evaluated
at runtime. If a constant is not declared volatile and the compiler is not being
run in debug mode, the compiler may fold constants which are known at compile time
into literals. However, it is not required to do this.

Note that because constants are globally available, yet assigned at runtime, a
constant is only valid after its declaration. Despite being a constant, the
assignment shall be executed every time the program passes over the \texttt{const}
line.

%%%%%%%%
% RETURN
\subsection{Return (\texttt{return})}
\label{sub:statements:return}

%%%%%%%%
% SWITCH
\subsection{Value-based branch (\texttt{switch})}
\label{sub:statements:switch}

%%%%
% IF
\subsection{Conditional (\texttt{if}---\texttt{else})}
\label{sub:statements:if}

%%%%%
% FOR
\subsection{Value-based iteration (\texttt{for})}
\label{sub:statements:for}

%%%%%%%%%
% FOREACH
\subsection{Sequence-based iteration (\texttt{foreach})}
\label{sub:statements:foreach}

%%%%
% DO
\subsection{Post-conditional loop (\texttt{do}---\texttt{while})}
\label{sub:statements:do}

%%%%%%%
% WHILE
\subsection{Pre-conditional loop (\texttt{while})}
\label{sub:statements:while}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SCOPE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Scope}
\label{sec:scope}
\begin{verbatim}
Scope = ("{", [{(Scope}], "}" |
         ((Statement | Expression), ";") ) ;
\end{verbatim}
A scope is a block of code and all associated variables and constants. When a
variable or constant is declared, it is valid in the scope in which it is declared,
and in all child scopes. A variable may be redeclared in a scope, which overrides
the declaration for that scope and its children. For example:
\begin{verbatim}
{
    let x: 2;
    // x is 2 here
    {
        let x: "Hello";
        // x is "Hello" here
    }
    // x is still 2 here
}
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% GLOBALS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Globals}
\label{sec:globals}

\subsection{Package-local globals}
\label{sub:globals:local}

\subsection{Externally visible globals}
\label{sub:globals:visible}

\subsection{Package-external globals}
\label{sub:globals:extern}

\subsection{Thread-local globals}
\label{sub:globals:threadlocal}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CLASSES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Classes}
\label{sec:classes}

\subsection{Defining classes}
\label{sub:classes:definition}

\subsection{Static variables}
\label{sub:classes:static}

\subsection{Thread-local static variables}
\label{sub:classes:threadlocal}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% METHODS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methods}
\label{sec:methods}

\subsection{Defining methods}
\label{sub:methods:definition}

\subsection{Package-external methods}
\label{sub:methods:extern}

\subsection{Static methods}
\label{sub:methods:static}

\subsection{Name mangling and \texttt{nomangle}}
\label{sub:methods:mangle}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% COMPILE PASSES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Compile passes}
\label{sec:passes}

\subsection{Arithmetic folding}
\label{sub:passes:arithfold}

\end{document}
